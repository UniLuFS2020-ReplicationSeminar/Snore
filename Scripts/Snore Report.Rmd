---
title: "Snore"
date: "2023-03-11"
output: 
    html_document:
      toc: true
      toc_float: true
      theme: united
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#install.packages("tidyverse")
#nstall.packages("dplyr")
library("rio")
library("dplyr")
library("tidyverse")
library("ggplot2")
# ------- 1. Importing and Cleaning
# Import data
sleep_data <- import("C:\\Users\\amand\\OneDrive\\Bureau\\Snore\\Sleep_Efficiency.csv")
```

# Snore Project
## Introduction

The aim of the project is to analyze the factors that are effecting sleep efficiency. The data set
is one of the Kaggle dataset and called "Sleep Efficiency Dataset". The dataset provides data on a group of test volunteers and their sleeping habits. Each subject has a "Subject ID" and "Sleep efficiency" feature is a measure of the proportion of time spent in bed that is actually spent asleep.
The data also contains information on each subject's caffeine and alcohol use in the 24 hours before bedtime, smoking status, and exercise frequency.

### Research Question
How do people's lifestyle and habits affect the length and quality of their sleep?
Does gender also have an effect on sleep quality?

### Hypotheses
People who consume more alcohol, caffeine and tobacco are likely to sleep less efficiently.
Conversely, people who exercise more are likely to sleep more efficiently.

### 2. Data Visualisation 1: Impact of caffeine consumption on sleep efficiency

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library("dplyr")
# Histogram of age distribution
histogram_caffeine <- sleep_data %>% 
  na.omit(`Caffeine consumption`) %>% 
  ggplot(aes(`Caffeine consumption`))+
  geom_histogram(stat="count")

# Divide caffeine consumption into groups:
# None=0
# Low+ 25
# Medium=50
# High >=75

sleep_data_caffeine_groups <- sleep_data %>% 
  na.omit(`Caffeine consumption`) %>% 
  mutate(caffeine_group=case_when(`Caffeine consumption`==0 ~ "None",
                                  `Caffeine consumption` ==25 ~ "Low (25mg)",
                                  `Caffeine consumption` ==50 ~ "Medium (50mg)",
                                  TRUE ~ "High (75mg-200mg)"))

# Convert caffeine consumption groups column to factor variable 
sleep_data_factor <- sleep_data_caffeine_groups %>% 
  mutate(caffeine_group= factor(caffeine_group,
                                ordered=TRUE,
                                levels=c("None","Low (25mg)","Medium (50mg)","High (75mg-200mg)")))


# Box plots indicating how caffeine consumption affects sleep efficiency
caffeine_sleep_efficiency <- ggplot(sleep_data_factor, aes(x=caffeine_group, y=`Sleep efficiency`)) + 
  geom_boxplot()+
  xlab(" Amount of Caffeine Consumed")+
  ylab("Sleep Efficiency")+
  ggtitle("Effect of Caffeine Consumption on Sleep Efficiency")+
  theme_minimal()

caffeine_sleep_efficiency
```

### 2. Data Visualisation 2: Impact of exercise frequency on sleep efficiency

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# ------- Data Visualisation 2: Impact of exercise frequency on sleep efficiency

# Histogram of exercise frequency distribution
histogram_exercise <- sleep_data %>% 
  drop_na(`Exercise frequency`) %>% 
  ggplot(aes(`Exercise frequency`))+
  geom_histogram(stat="count")

# Divide exercise frequency into groups:
# None=0
# Low+ 1
# Medium=2-3
# High =4-5

sleep_data_exercise_groups <- sleep_data %>% 
  drop_na(`Exercise frequency`) %>% 
  mutate(exercise_group=case_when(`Exercise frequency`==0 ~ "None",
                                  `Exercise frequency` ==1 ~ "Low (1)",
                                  `Exercise frequency` >1 &`Exercise frequency` <4 ~ "Medium (2-3)",
                                  `Exercise frequency` >=4 & `Exercise frequency` <6 ~ "High (4-5)"))

# Convert exercise groups column to factor variable 
sleep_data_factor_exercise <- sleep_data_exercise_groups %>% 
  mutate(exercise_group= factor(exercise_group,
                                ordered=TRUE,
                                levels=c("None","Low (1)","Medium (2-3)","High (4-5)")))


# Box plots indicating how exercise frequency affects sleep efficiency
exercise_sleep_efficiency <- ggplot(sleep_data_factor_exercise, aes(x=exercise_group, y=`Sleep efficiency`)) + 
  geom_boxplot()+
  xlab(" Exercise Frequency")+
  ylab("Sleep Efficiency")+
  ggtitle("Effect of Exercise frequency on Sleep Efficiency")+
  theme_minimal()

exercise_sleep_efficiency

```


